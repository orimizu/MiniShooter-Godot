# 弾幕系縦シューティング 改善計画書

## 目次
1. [現状分析](#現状分析)
2. [改善計画概要](#改善計画概要)
3. [優先度別実装計画](#優先度別実装計画)
4. [詳細改善案](#詳細改善案)
5. [実装ロードマップ](#実装ロードマップ)

---

## 現状分析

### ゲームの強み
- **安定した基盤**: Godot 4.4ベースの堅牢な実装
- **美麗なピクセルアート**: 8x8ドットの2色グラデーション敵キャラクター
- **物理演算なしの精密制御**: Area2Dベースの正確な移動・衝突判定
- **基本システムの完成度**: 弾丸、敵、プレイヤーの基本的な動作が安定

### 現在の問題点

#### 1. ゲームバランスの課題
- **攻撃力増加が急激**: スコア3000で16方向弾は強すぎる
- **ライフ数が多すぎ**: 20ライフは緊張感を削ぐ
- **敵の単調さ**: 全敵が体力1、攻撃パターンが16方向弾のみ
- **難易度調整不足**: スコアベースの敵出現率計算が不適切

#### 2. UI/UXの課題
- **当たり判定の不明確さ**: プレイヤーの1px判定が視覚的に分からない
- **情報表示の問題**: EnemyRateなど分かりにくい表示
- **操作説明の不足**: 新規プレイヤーに不親切
- **フィードバック不足**: 撃破時のエフェクトが弱い

#### 3. ゲーム性の課題
- **単調なゲームプレイ**: ひたすら敵を撃つだけ
- **戦略性の不足**: ボム以外に戦術的要素がない
- **目標の不明確さ**: ハイスコア以外のモチベーションがない
- **リプレイ性の低さ**: 一度クリアすると飽きやすい

#### 4. 技術的課題
- **パフォーマンス問題**: 大量弾生成時の処理重複
- **削除処理のバグリスク**: 配列操作の安全性不足
- **メモリ効率**: オブジェクトの使い回し不足

---

## 改善計画概要

### 基本方針
1. **段階的改善**: 既存システムを壊さずに機能追加
2. **プレイヤー体験重視**: UIとフィードバックの大幅改善
3. **戦略性の導入**: 単調さを解消する多様な選択肢
4. **長期的楽しさ**: リプレイ性とモチベーション要素の強化

### 改善の3段階アプローチ

#### Phase 1: 基盤強化（優先度: 高）✅ 完了
- ゲームバランスの調整
- UI/UXの大幅改善
- 基本システムの安定化

**Phase 1 実装内容**:
- ライフシステムを5に調整（戦略性と緊張感のバランス）
- 色別敵体力・得点システム（赤10点→マゼンタ50点）
- プレイヤー攻撃の段階的強化（1000/3000/6000点で解放）
- 当たり判定可視化（青い十字マーク、被弾時赤）
- パーティクルエフェクト（敵色対応の爆発、スコアポップアップ）
- 画面振動・フラッシュエフェクト（Camera2D使用）
- プログラム生成サウンドシステム（4種類の効果音）

#### Phase 2: ゲーム性拡張（優先度: 中）← 次はここから
- 新システムの追加
- コンテンツの多様化
- 戦略性の向上

#### Phase 3: 長期対応（優先度: 低）
- 高度な機能追加
- ソーシャル要素
- カスタマイズ機能

---

## 優先度別実装計画

### 🔴 優先度: 高（Phase 1 - 2週間）✅ 完了

#### 1.1 ゲームバランス調整 ✅
- **ライフシステム見直し**: ~~20→3に変更~~ → 5に決定して実装
- **プレイヤー攻撃力調整**: 段階的弾数増加（3→5→7→9方向）✅
- **敵体力システム**: 色別体力設定（赤:1, 黄:2, シアン:3, 青:2, 緑:4, マゼンタ:5）✅
- **難易度カーブ調整**: より自然な敵出現レート計算式 ✅

#### 1.2 UI/UX大幅改善 ✅
- **当たり判定可視化**: プレイヤー中央に十字マーク表示 ✅
- **情報パネル再設計**: ~~アイコンベース~~ → 星マークによる難易度表示 ✅
- **撃破エフェクト**: 敵撃破時のパーティクル効果 ✅
- **ダメージフィードバック**: 被弾時の画面振動・赤フラッシュ ✅

#### 1.3 基本システム安定化 ✅
- **オブジェクト削除の安全化**: 逆順ループによる配列操作 ✅
- **パフォーマンス最適化**: 不要な衝突判定の削減 ✅
- **音響効果**: 射撃音、撃破音、被弾音の追加 ✅

### 🟡 優先度: 中（Phase 2 - 4週間）前半完了

#### 2.1 ハイスコアシステム ✅
- **ローカル保存**: 上位10位までのスコア記録 ✅
- **スコア表示画面**: ランキング形式での表示 ✅
- **記録更新演出**: 新記録達成時の特別エフェクト ✅

**実装内容**:
- HighScoreManager.gdによるセーブ/ロード機能
- 専用のハイスコア画面（タイトル/ゲームオーバーからアクセス可能）
- ランク別カラー（1位:ゴールド、2位:シルバー、3位:ブロンズ）
- 新記録時の点滅アニメーションとスケール効果

#### 2.2 ステージシステム ✅
- **5ステージ構成**: 各ステージ異なるテーマと背景 ✅
- **ボスキャラクター**: 各ステージ終了時のボス戦（未実装）
- **ステージクリア演出**: 達成感のあるクリア画面 ✅

**実装内容**:
- StageManager.gdによる5ステージ管理
- ステージごとの背景色（緑→青→黄→赤→紫）
- 敵出現パターンのステージ別調整
- 難易度倍率（1.0x→2.0x）による段階的難易度上昇
- 画面上部の大型プログレスバー（ステージ色対応、90%で点滅警告）
- ステージクリア/全クリア演出（ゴールドテキスト、フラッシュ効果）

#### 2.3 ボスキャラクターシステム ✅
- **5種類のボス**: ステージごとに異なる強力なボス敵 ✅
- **3段階攻撃パターン**: 体力減少で攻撃が激化（8→16→24方向弾） ✅
- **視覚的体力バー**: ボス上部にリアルタイム表示 ✅
- **ステージ統合**: 55秒でボス出現、撃破でステージクリア ✅

**実装内容**:
- Boss.gd/Boss.tscnによる32x32ピクセルボス
- ステージ別ボス設定（50-150HP、1000-5000点）
- 左右移動 + 段階的弾幕攻撃パターン
- プレイヤー弾丸との衝突検出とダメージシステム

#### 2.4 パワーアップシステム ✅
- **5種類のアイテム**: P(攻撃力)、S(移動速度)、R(連射)、B(ボム)、1UP ✅
- **ドロップ機能**: 敵撃破時10%確率、1UPは1%の超レア ✅
- **持続効果システム**: P/S/Rは30秒間のブースト効果 ✅
- **視覚的デザイン**: 各アイテム独自の16x16ピクセルアート ✅

**実装内容**:
- PowerUp.gd/PowerUp.tscnによるアイテムシステム
- GameManager統合（タイマー管理、効果適用、衝突検出）
- 専用パワーアップ音（400Hz→800Hz上昇音）
- 自動削除タイマー（10秒後に点滅して消失）

#### 2.5 敵システム拡張（Phase 3へ延期）
- **特殊攻撃パターン**: 渦巻き弾、追尾弾、レーザーなど
- **特殊敵タイプ**: 分裂敵、シールド敵、ワープ敵
- **敵の行動AI**: より戦略的な敵の動き

### 🟢 優先度: 低（Phase 3 - 8週間）

#### 3.1 難易度選択
- **4段階難易度**: Easy, Normal, Hard, Lunatic
- **難易度別報酬**: 高難易度クリア時の特別アンロック

#### 3.2 アチーブメントシステム
- **実績システム**: 様々な条件達成による称号獲得
- **プログレス追跡**: 統計情報の表示

#### 3.3 カスタマイズ機能
- **プレイヤースキン**: 機体の見た目変更
- **弾軌道エフェクト**: 弾の見た目カスタマイズ
- **BGM選択**: 好みの背景音楽設定

---

## 詳細改善案

### A. ゲームバランス改善

#### A1. ライフシステム見直し
```
現在: ライフ20（多すぎて緊張感不足）
改善後: ライフ3（1UPアイテムで最大5まで増加可能）
効果: 一撃の重みが増し、緊張感のあるゲームプレイ
```

#### A2. プレイヤー攻撃力調整
```
現在: 500点で6方向、1000点で8方向、2000点で12方向、3000点で16方向
改善後: 
- 初期: 3方向（前・右前・左前）
- 1000点: 5方向（後ろ2方向追加）
- 3000点: 7方向（左右2方向追加）
- 6000点: 9方向（斜め4方向追加）
効果: より段階的で適切な成長カーブ
```

#### A3. 敵体力・色別差別化
```
赤: 体力1, 基本敵
黄: 体力2, 速度1.5倍
シアン: 体力3, 弾速1.5倍
青: 体力2, ランダム速度変化
緑: 体力4, 画面端反射
マゼンタ: 体力5, 特殊攻撃パターン
```

### B. UI/UX改善

#### B1. 当たり判定可視化
- プレイヤー中央に2px×2pxの十字マーク
- 被弾時に一瞬拡大してフィードバック
- 設定でON/OFF切り替え可能

#### B2. 情報表示改善
```
現在の問題: "EnemyRate: 0.05" など数値のみ
改善案:
- スコア: 大きく見やすいフォント + アイコン
- ライフ: ハート型アイコン表示
- ボム: 爆弾アイコン + 残回数
- ステージ: 進行度バー表示
```

#### B3. 視覚効果強化
- **撃破エフェクト**: パーティクル爆発、スコア表示ポップアップ
- **被弾エフェクト**: 画面振動、赤フラッシュ、無敵時間の点滅
- **ボムエフェクト**: より派手な全画面フラッシュ + 衝撃波

### C. 新システム導入

#### C1. ボスキャラクターシステム
```
各ステージのボス特徴:
Stage 1: 基本ボス（単純な弾幕パターン）
Stage 2: 速度ボス（高速移動 + 追尾弾）
Stage 3: 防御ボス（シールド + レーザー攻撃）
Stage 4: 分裂ボス（分身 + 連携攻撃）
Stage 5: 最終ボス（全パターン複合）

共通仕様:
- 体力: 50-100
- 3段階攻撃パターン（体力減少で変化）
- 撃破時の特別演出とボーナススコア
```

#### C2. パワーアップアイテム
```
ドロップ率: 敵撃破時10%
アイテム種類:
- P (Power): 攻撃力一時UP（30秒）
- S (Speed): 移動速度UP（30秒）
- R (Rapid): 連射速度UP（30秒）
- B (Bomb): ボム回数+1
- 1UP: ライフ+1（超レア、1%）

取得演出: アイテム名表示 + 効果音
```

#### C3. グレイズシステム
```
仕様: 敵弾に接触せずに3px以内に近づく
効果: 1グレイズ = 10ポイント
戦略性: リスクを取ってスコアアップを狙う
表示: グレイズ数カウンタ + 連続グレイズボーナス
```

### D. ステージシステム

#### D1. ステージ構成
```
各ステージ仕様:
- 長さ: 60秒間の敵ウェーブ + ボス戦（30秒）
- テーマ: 異なる背景色と音楽
- 敵構成: ステージごとに主要敵色を変更
- 難易度: ステージが進むほど敵の体力・速度UP

Stage 1 (緑): 基本ステージ、チュートリアル的
Stage 2 (青): 速度重視、素早い敵が多数
Stage 3 (黄): 弾幕重視、弾密度が高い
Stage 4 (赤): バランス型、全種敵が登場
Stage 5 (紫): 最終ステージ、最高難易度
```

#### D2. ステージクリア演出
- クリア時の専用BGM
- 獲得スコア・統計の詳細表示
- 次ステージへの期待感を煽る演出

---

## 実装ロードマップ

### Week 1-2: Phase 1 基盤強化 ✅ 完了
- [x] ライフシステム変更（20→5）
- [x] プレイヤー攻撃力バランス調整
- [x] 当たり判定可視化実装
- [x] 基本音響効果追加
- [x] UI情報表示改善

### Week 3-4: Phase 1 完成 ✅ 完了
- [x] 敵体力システム実装
- [x] 撃破・被弾エフェクト追加
- [x] パフォーマンス最適化
- [x] バグ修正・安定化

### Week 5-6: Phase 2 コア機能（完了）
- [x] ハイスコア保存システム
- [x] ステージシステム基盤
- [x] 全5ステージボス実装
- [x] パワーアップシステム完成

### Week 7-8: Phase 2 完成
- [x] ボスキャラクターシステム完成
- [x] パワーアップドロップ・効果システム
- [x] 音響効果（パワーアップ音）追加
- [x] システム統合とバランス調整

### Week 9-12: Phase 3 高度機能
- [ ] 難易度選択システム
- [ ] アチーブメントシステム
- [ ] グレイズシステム
- [ ] 統計・記録機能

### Week 13-16: Phase 3 完成・磨き込み
- [ ] カスタマイズ機能
- [ ] 追加音楽・効果音
- [ ] 最終バランス調整
- [ ] 総合テスト・デバッグ

---

## 成功指標

### 定量的指標
- **平均プレイ時間**: 現在5分 → 目標15分
- **リプレイ率**: プレイヤーの60%以上が再プレイ
- **ステージクリア率**: Stage 1を90%以上がクリア可能
- **パフォーマンス**: 60FPS安定動作

### 定性的指標
- **プレイヤーフィードバック**: 面白さ・やりがいの向上
- **学習曲線**: 新規プレイヤーが理解しやすい
- **戦略性**: プレイヤーの選択による結果の違い
- **達成感**: クリア時・記録更新時の満足度

---

## まとめ

この改善計画により、現在の安定した基盤を活かしながら、弾幕シューティングゲームとしての面白さを大幅に向上させることができます。

**重要なポイント**:
1. **段階的実装**: 既存機能を壊さずに改善
2. **プレイヤー体験重視**: UI/UXとフィードバックを最優先
3. **バランス調整**: 緊張感と達成感の適切な配分
4. **長期的価値**: リプレイ性と継続的楽しさの確保

この計画に沿って実装することで、単純だった弾幕ゲームが戦略性と深みのある本格的なシューティングゲームに進化するでしょう。